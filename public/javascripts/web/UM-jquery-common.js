(function(e){e.chartCache={},e.hashCache=[],window.uploadFileWait=!1,e.fn.extend({renderChart:function(t){var n={chart:{defaultSeriesType:"area",animation:!0,height:300},yAxis:{title:"",min:0},credits:{enabled:!1},plotOptions:{area:{stacking:null,fillColor:{linearGradient:[0,0,0,300],stops:[[0,"rgb(160, 192, 193)"],[1,"rgba(255,255,255,0)"]]},marker:{symbol:"circle",fillColor:"#FFFFFF",lineWidth:2,lineColor:null}},series:{animation:!0,events:{legendItemClick:function(e){var t=this.name+"_<dot>",n=this.chart.series,r=n.length;for(var i=0;i<r;i++)n[i].name==t&&(n[i].visible?n[i].hide():n[i].show())}}}},tooltip:{enabled:!0,formatter:function(){return""+this.x+"日"+this.series.name+" : "+this.y}},legend:{margin:25,enabled:!0},subtitle:{}},r=e.extend(!0,{},n,t||{});return this.each(function(){r.chart.renderTo=e(this).attr("id");try{e.chartCache(e(this).attr("id")).destroy()}catch(t){e.chartCache[e(this).attr("id")]=new Highcharts.Chart(r)}})},ajaxBlock:function(t){var n={message:"<img src='/imgs/xp/ajax-load.gif'/>",css:{width:"16px",border:"none",background:"none"},overlayCSS:{backgroundColor:"#FFF",opacity:.8},baseZ:997},r=e.extend(!0,{},n,t||{});return this.each(function(){e(this).block(r)})},timeFilterTab:function(t){var n={callback:null,selIndex:0,tabs:[{text:"今天",paramName:"period",paramVal:"today"},{text:"过去7天",paramName:"period",paramVal:"-7"},{text:"上周",paramName:"period",paramVal:"lastWeek"},{text:"上月",paramName:"period",paramVal:"lastMonth"},{text:"上季度",paramName:"period",paramVal:"lastQuarter"},{text:"自定义时间",paramName:"period",paramVal:"custom"}]};return t=e.extend(n,t||{}),this.each(function(){e(this).append(e("#time-filter-tmpl").tmpl(t,{getStatus:function(e){return e==this.data.selIndex?"sel":""}}));var n=e(this).find(".filter"),r=n.find("li:eq("+t.selIndex+")");n.find(".bg").animate({left:r.position().left+10,width:r.outerWidth()},500,"easeInOutCubic"),n.find("li").click(function(){e(this).addClass("sel").siblings("li").removeClass("sel"),n.find(".bg").animate({left:e(this).position().left+10,width:e(this).outerWidth()},500,"easeInOutCubic");if(e("a",this).attr("period")=="custom"){var r=e(this).closest(".filter").find(".custom").slideDown(300);r.find(".from").datepicker({defaultDate:"+1w",dateFormat:"yy-mm-dd",dayNamesMin:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],numberOfMonths:2,onSelect:function(e){r.find(".to").datepicker("option","minDate",e)}}),r.find(".to").datepicker({defaultDate:"+1w",dateFormat:"yy-mm-dd",dayNamesMin:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],numberOfMonths:2,onSelect:function(e){r.find(".from").datepicker("option","maxDate",e)}}),r.find(".btn_small_green").unbind("click").click(function(){e(this).closest(".filter").find(".custom").slideUp(300),t.callback&&t.callback.call(this,t)})}else e(this).closest(".filter").find(".custom").slideUp(300),t.callback&&t.callback.call(this,t)})})},blockTab:function(t){var n={tabfors:e(".bodys"),callback:null,type:"normal",data:[]};return t=e.extend(n,t||{}),t.tabfors.data("opt",t),this.each(function(){e(this).find(".item").click(function(){t.type=="normal"&&e(this).closest(".sub_head").find(".bg").animate({left:e(this).position().left+167,width:e(this).width()},500,"easeInOutCubic"),e(this).addClass("sel").siblings(".item").removeClass("sel"),e.tabSlideTo(e(this),t),t.callback&&t.callback.apply(this,t.data)})})},checkBox:function(t){var n={type:"single",group:"closed",callback:null};return t=e.extend(n,t||{}),this.each(function(){function r(){var t=e(".sel",n).attr("group");e(".btn_checkbox",n).removeClass("disabled"),t&&e(".btn_checkbox:not([group="+t+"])").addClass("disabled")}var n=this;r(),e(".btn_checkbox",n).on("click",function(){e(this).hasClass("disabled")||(t.group=="closed"?t.type=="single"?e(this).addClass("sel").closest(".check_box").find(".btn_checkbox").not(this).removeClass("sel"):t.type=="multi"?e(this).toggleClass("sel"):(e(this).toggleClass("sel"),e(this).hasClass("sel")&&e(this).siblings(".btn_checkbox").removeClass("sel")):(e(this).toggleClass("sel"),r()),e(e(n).attr("linkfor")).val(e(".sel",n).map(function(){return e(this).attr("val")}).get().join(",")).trigger("change"),e(e(n).attr("groupfor")).val(e(".sel",n).attr("group")).trigger("change"),t.callback&&t.callback.call(this,t))})})},selectList:function(t){var n={defaultVal:"请选择",callback:null,val:"",platform:"",className:"",id:"",list:[]};return t=e.extend(n,t||{}),this.each(function(){var n=this;e(this).attr("inputid")&&(t.id=e(this).attr("inputid")),e(this).html(e("#select-custom").tmpl(t)),e(this).find(".select_input").off("click").on("click",function(){e(this).next().slideToggle(300)}),e(this).find(".select_option li").off("click").on("click",function(){var r=e(e(n).find(".select_input").attr("linkfor"));r.val(e(this).attr("val")),e(n).find(".select_input .select_value").text(e(this).text()),e(this).closest(".select_option").slideUp(300),t.callback&&t.callback.call(this,t)})})},addOperateBtns:function(t){var n={list:".ad_item",callback:null};return t=e.extend(n,t||{}),this.each(function(){var n=e(e("#operate-btns").html());n.find(".btn_small_black").on("click",function(){t.callback&&t.callback.call(this,t)}),e(this).append(n)})},checkAll:function(t){return this.each(function(){e(this).on("click",function(){e(e(this).attr("selectAll")).prop("checked",e(this).prop("checked"))})})},advanceSet:function(t){return this.each(function(){e(this).click(function(){e(this).toggleClass("expand");var n=e(e(this).attr("setfor"));n.is("tr,td")?n.is(":hidden")?(n.show(),n.find("td>div").slideDown(300)):n.find("td>div").slideUp(300,function(){n.hide()}):n.slideToggle(300),t&&t.call(this)})})},setPrior:function(t){var n=[{value:"最高",statusBar:"prior_bar_red",val:"5"},{value:"高",statusBar:"prior_bar_yellow",val:"4"},{value:"中",statusBar:"prior_bar_green",val:"3"},{value:"低",statusBar:"prior_bar_blue",val:"2"},{value:"最低",statusBar:"prior_bar_pink",val:"1"}];return this.each(function(){var r;e(this).on("click",function(i){i.stopPropagation();var s=this,o={getStatus:function(){return this.data.val==e(s).attr("val")?"sel":""}};r=e('<ul class="prior_set dn"></ul>').append(e("#prior-set").tmpl(n,o)),r.appendTo("body");var u=e(this).parent().offset().left+(e(this).parent().width()-r.width())/2,a=e(this).parent().offset().top;r.css({left:u,top:a}).slideDown(300),r.find("li").click(function(){e(this).addClass("sel").siblings("li").removeClass("sel"),t&&t.call(s,{val:e(this).attr("val"),value:e(".prior_text",this).text()}),e(this).closest(".prior_set").slideUp(300,function(){e(this).remove()})})})})},createAreaOpt:function(t){var n={callback:null,linkInput:e("#areas"),id:"",parentBody:e("body")};t=e.extend(n,t||{}),function(t){return this.each(function(){var n=this;t.id="sub_body_"+e.getToken(),t.parentBody.append(e("#sub-pop-area").tmpl(t));var r=e("#"+t.id);e(this).attr("area","#"+t.id),r.find("tr.tb_title").click(function(){e(this).nextUntil("tr.tb_title").find("input").prop("checked",e(this).find("input").prop("checked"))}),r.find("tr.area_list span.sub_title").click(function(){e(this).nextAll("input").prop("checked",e(this).find("input").prop("checked"))}),r.find(".region_cancel").click(function(){r.animate({right:-r.outerWidth()-10+"px"},500)}),r.find(".region_ok").click(function(){var i=r.find("tr.area_list td>:checkbox").map(function(t,n){if(e(n).prop("checked"))return e(n).prev("label").text()}).get().join(",");i.split(",").length===37||i.length===0?e(n).find(".btn_checkbox.all").trigger("click"):(t.linkInput.val(i),e(n).find(".btn_checkbox.special").attr("val",i)),r.animate({right:-r.outerWidth()-10+"px"},500)}),e(this).find(".btn_checkbox.all").click(function(){t.linkInput.val("all")}),e(n).find(".btn_checkbox.special").click(function(){r.find(":checkbox").prop("checked",!1),t.linkInput.val()!=="all"?r.find("tr.area_list td>label").each(function(n,r){var i=t.linkInput.val();i.indexOf(e(r).text())>-1&&e(r).next("input").prop("checked",!0)}):r.find(":checkbox").prop("checked",!0),r.animate({right:"10px"},500)})})}.call(this,t)},pageNav:function(t,n){function i(e,n){var r="",i,s;i=n-t.viewCount,s=n+t.viewCount,i<1&&(s=s-i+1),s>e&&(i=i-s+e);for(var o=0;o<e;o++)o===0||o==e-1||o+1>=i&&o+1<=s?r+='<a class="'+(o+1==n?"current":"")+'" p="'+(o+1)+'">'+(o+1)+"</a>":o==e-2?s<e-2?r+='<a class="dot" p="'+(o+1)+'">...</a>':r+='<a  p="'+(o+1)+'">'+(o+1)+"</a>":o==1&&(i>3?r+='<a class="dot" p="'+(o+1)+'">...</a>':r+='<a  p="'+(o+1)+'">'+(o+1)+"</a>");return r}var r={ajaxUrl:"",totalPages:20,tmpl:null,viewCount:3,callback:null,pageFor:e(".table_body table tbody"),ajaxBlocker:e(".table_body"),current:1};return t=e.extend(r,t||{}),this.each(function(){var n=e('<div class="pagin">'),r=i(t.totalPages,t.current);n.append(r),n.find("a:not(.current)").click(function(){t.callback&&t.callback.call(this,t,i)}),e(this).html(n)})},tipImageShow:function(){return this.each(function(){var t=e(e(this).attr("show")),n,r,i,s;e(this).hover(function(s){var o=new Image;o.src=e(this).attr("href"),o.width>350&&(o.height=o.height*350/o.width,o.width=350),i=e(window).width(),windowH=e(window).height(),r=e(this).offset().left+e(this).width(),n=e(this).offset().top+e(this).height(),e(this).attr("href").indexOf("baidu")<0?t.attr("src",e(this).attr("href")).width(o.width).height(o.height).show():t.attr("src",e(this).attr("href")+"&rnd="+Math.random()).width(o.width).height(o.height).show(),r-=i-e(this).offset().left+e(window).scrollLeft()<o.width?o.width:0,n-=windowH-e(this).offset().top+e(window).scrollTop()<o.height+20?o.height+25:0,t.css("left",r),t.css("top",n)},function(e){t.hide().attr("src","")})})},umSlider:function(t){var n={init:function(t){var n={speed:10,step:1,auto:!1,leftBtn:null,direction:"left",rightBtn:null,stop:!1,pauseOnHover:!1,pagin:null,slideIndex:0};return t=e.extend(n,t||{}),this.each(function(){var n=this,r=e("li",this).outerHeight(),i=e("li",this).outerWidth();e(this).css({width:i+"px",height:r+"px",overflow:"hidden",position:"relative",zoom:1}),e("ul",this).css({width:i*e("li",this).length+"px",position:"absolute"}),e("li",this).css({"float":"left"});if(t.auto){var s=function(){t.stop||(e(n).umSlider(t.direction=="left"?"slideLeft":"slideRight",t),setTimeout(function(){s()},t.speed))};setTimeout(function(){s()},t.speed)}else t.leftBtn.click(function(){e(n).umSlider("slideRight",t)}),t.rightBtn.click(function(){e(n).umSlider("slideLeft",t)})})},slideLeft:function(t){t=t||{step:1};var n=e("li",this).outerWidth(),r=e("li",this).length;t.slideIndex<r-1?(++t.slideIndex,e("ul",this).animate({left:"-="+t.step*n},300,function(){t.pagin.children(".sel").removeClass("sel"),t.pagin.children().eq(t.slideIndex).addClass("sel")})):t.stop=!0},slideRight:function(t){t=t||{step:1};var n=e("li",this).outerWidth();t.slideIndex>0?(--t.slideIndex,e("ul",this).animate({left:"+="+t.step*n},300,function(){t.pagin.children(".sel").removeClass("sel"),t.pagin.children().eq(t.slideIndex).addClass("sel")})):t.stop=!0}};if(n[t])return n[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return n.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.tooltip")}}),e.extend({getSearchParamVal:function(e,t){var n=(new RegExp(t+"="+"([^&]*)&?","i")).exec(e);return n?n[1]:""},renderNormalChartOpt:function(e,t,n){e.renderChart({chart:{renderTo:e.attr("id")},title:"",xAxis:{categories:n,labels:{align:"right",step:parseInt(n.length/7)}},series:t})},getToken:function(){return Math.random().toString(16).substring(2)},tabSlideTo:function(t,n){var r=e(t.attr("tabfor")),i=n.tabfors.children(".tab_show").index(r);n.tabfors.children(".tab_show").removeClass("dn sel"),r.addClass("sel"),n.tabfors.animate({left:-1e3*i+"px"},500,"easeInOutCubic",function(){e.bodyAutoFit()})},bodyAutoFit:function(){var t=0,n=e(".bodys .body.sel"),r=n.find(".sub_body.sel");r.length>0?t=r.outerHeight()+40:t=n.outerHeight(),e(".bodys").animate({height:t+"px"},300,"easeOutCubic")},cookie_get:function(e){var t=document.cookie.split("; ");g=t.length,f=[];for(var n=0;n<g;n++){f=t[n].split("=");if(e===f[0])return unescape(f[1])}return null},cookie_set:function(e,t,n){var r=new Date;n?r.setDate(r.getDate()-10):r.setDate(r.getDate()+1),document.cookie=e+"="+escape(t)+"; expires="+r.toGMTString()+"; path=/"},popBox:function(t){var n={h_title:"test",body:"",animation:"slideFromTop",width:518,dialog_id:"dialog_"+e.getToken(),b_title:"",callback:null,closeHash:"",buttons:[{name:"ok",className:"",click:null}]};e.removePopBox(),t=e.extend(n,t||{}),e("body").append(e("#pop-box").tmpl(t)).css({overflowY:"hidden"});var r=e("#"+t.dialog_id).find(".pop_dialog");r.attr("route",t.closeHash),r.css({width:t.width+20+"px"}),e.each(t.buttons,function(n,i){var s=e('<button id="btn_'+n+'" class="btn_mid_green '+i.className+'">'+i.name+"</button>");typeof i.click=="function"&&s.on("click",i.click).data("opt",t).appendTo(r.find(".pop_dialog_foot .buttons"))}),e("#"+t.dialog_id).fadeIn(300,function(){r.css({top:-r.height()+"px"});var n;typeof t.callback=="function"&&t.callback(t),n=(e(window).height()-r.height())/2,t.animation=="fade"?r.css({top:(n<0?0:n)+"px"}).fadeIn(300):r.animate({top:(n<0?0:n)+"px"},300,function(){}),e("#"+t.dialog_id).find(".close").on("click",function(){e.closePopBox(e(this).closest(".pop_dialog"),t)})})},removePopBox:function(){e("body .mark").remove(),e("body").css({overflowY:"auto"})},closePopBox:function(t,n){function r(){e(this).closest(".mark").fadeOut(300).remove(),e("body").css({overflowY:"auto"})}location.hash=e.hashCache[e.hashCache.length-1],n&&n.animation=="fade"?t.fadeOut(300,function(){r.call(this)}):t.animate({top:-t.height()+"px"},300,function(){r.call(this)})},initHoverShow:function(t){e("dl.combine_val:not(.noshow)",t).hover(function(){e(this).stop().animate({top:"-45px"},500,"easeInOutCubic")},function(){e(this).stop().animate({top:"0"},500,"easeInOutCubic")}),e("td",t).hover(function(){e(".hover_show",this).stop().animate({right:"0"},500,"easeInOutCubic")},function(){e(".hover_show",this).stop().animate({right:"-100px"},500,"easeInOutCubic")})},alert:function(t,n){var r={h_title:"提示:",body:"",animation:"fade",width:240,dialog_id:"dialog_"+e.getToken(),b_title:"",callback:null,buttons:[{name:"关闭","class":"",click:function(){return e.closePopBox(e(this).closest(".pop_dialog"),{animation:"fade"}),!1}}]};r.body='<div style="background:white;line-height:30px;padding:10px;">'+t+"</div>",n=e.extend(r,n||{}),e.popBox(n)},confirm:function(t,n){var r={buttons:[{name:"确定","class":"",click:function(){var t=e(this).data("opt");return typeof t.sure=="function"&&t.sure.call(this,t),e.closePopBox(e(this).closest(".pop_dialog"),{animation:"fade"}),!0}},{name:"取消","class":"",click:function(){return e.closePopBox(e(this).closest(".pop_dialog"),{animation:"fade"}),!1}}]};n=e.extend(r,n||{}),e.alert(t,n)},pieInit:function(t){window.PIE&&~~e.browser.version<9&&t.find(".pie").each(function(){PIE.attach(this)})},upload:function(t,n,r,i,s,o){function u(){uploadFileWait=!0,e(s).removeAttr("novalidate");var o=e(s).attr("action");e(s+"_uploadType").val(n),e(s+"_fileObject").val(t.id),e(s+"_feedback").val(r),e(s+"_callback").val(i),e(s).attr("target","uploadFrame"),e(s).attr("action","/upload/uploadFile"),e(s)[0].submit(),e(s).attr("target","_self"),e(s).attr("action",o)}if(t&&e.verify_file(e(t))){e(t).parent().find("#loadingStatus").remove(),e(t).parent().after('<img id="loadingStatus" src="/imgs/xp/ajax-load.gif" width="20" height="20"/>');if(o&&o!="-"){var a=o.split("x");e(s+"_width").val(a[0]),e(s+"_height").val(a[1])}uploadFileWait?uploadFileHd=setInterval(function(){if(uploadFileWait)return!1;u(),clearInterval(uploadFileHd)},200):u()}},verify_file:function(t,n){var r=new RegExp(e(t).attr("rule"),"gi");if(!r.test(t.val()))return n||t.closest("td").next().html("<span class='err'>"+e(t).attr("title")+"</span>"),t.focus(),!1;var i=!1;if(t[0].files)i=t[0].files[0].size/1024>parseInt(t.attr("filesize"));else try{var s=new ActiveXObject("Scripting.FileSystemObject");i=s.GetFile(t.val()).size/1024>parseInt(t.attr("filesize"))}catch(o){t.closest("td").next().html("<span class='err'>建议使用非ie内核浏览器</span>")}return i?(n||(t.closest("td").next().html("<span class='err'>文件不得大于"+t.attr("filesize")+"K</span>"),t.focus()),!1):(t.closest("td").next().find(".err").remove(),!0)}})})(jQuery);